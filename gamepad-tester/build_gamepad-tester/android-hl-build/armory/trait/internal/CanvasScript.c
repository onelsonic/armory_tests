// Generated by HLC 4.0.0 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <armory/trait/internal/CanvasScript.h>
#include <kha/Image.h>
#include <haxe/ds/IntMap.h>
#include <zui/Canvas.h>
extern zui__$Canvas $g__zui_Canvas;
extern hl_type $t_i32;
void haxe_ds_IntMap_set(haxe__ds__IntMap,int,vdynamic*);
void hl_types_ArrayBytes_Int___expand(hl__types__ArrayBytes_Int,int);
extern hl_type $t_hl_types_ArrayObj;
#include <kha/Kravur.h>
#include <zui/Themes.h>
#include <haxe/format/JsonParser.h>
extern hl_type $t_zui_Zui;
extern hl_type $t_vrt_a1d25bf;
extern hl_type $t_kha_Kravur;
extern zui__$Themes $g__zui_Themes;
extern hl_type $t_vrt_019b9f1;
extern hl_type $t_vrt_d02fabb;
void zui_Zui_new(zui__Zui,vvirtual*);
extern hl_type $t_haxe_format_JsonParser;
String kha_internal_BytesBlob_toString(kha__internal__BytesBlob);
void haxe_format_JsonParser_new(haxe__format__JsonParser,String);
vdynamic* haxe_format_JsonParser_doParse(haxe__format__JsonParser);
extern hl_type $t_vrt_c48771a;
#include <hl/natives.h>
hl__types__ArrayBytes_Int hl_types_ArrayBase_allocI32(vbyte*,int);
extern hl_type $t_vrt_6bfdb92;
extern hl_type $t_String;
extern hl_type $t_ctx_69d0611;
extern hl_type $t_fun_78f6d38;
void iron_data_Data_getImage(String,vclosure*,bool*,String);
extern String $s_font_default_ttf;
extern hl_type $t_ctx_6313d79;
extern hl_type $t_fun_8ecbc05;
void iron_data_Data_getFont(String,vclosure*);
#include <kha/graphics2/Graphics.h>
hl__types__ArrayObj zui_Canvas_draw(zui__Zui,vvirtual*,kha__graphics2__Graphics);
hl__types__ArrayObj armory_system_Event_get(String);
extern hl_type $t_vrt_68dcaf9;
extern hl_type $t_fun_7b48b4f;
extern hl_type $t_vrt_5ee8da9;
int String___compare(String,vdynamic*);
#include <zui/Handle.h>
vdynamic* haxe_ds_IntMap_get(haxe__ds__IntMap,int);
void iron_Trait_new(iron__Trait);
extern String $s__json;
String String___add__(String,String);
extern hl_type $t_fun_45efdfd;
void iron_data_Data_getBlob(String,vclosure*);
extern hl_type $t_fun_3559b8d;
void iron_Trait_notifyOnRender2D(iron__Trait,vclosure*);

bool armory_trait_internal_CanvasScript_get_ready(armory__trait__internal__CanvasScript r0) {
	vvirtual *r2, *r3;
	bool r1;
	r2 = r0->canvas;
	r3 = NULL;
	if( r2 != r3 && (!r2 || !r3 || !r2->value || !r3->value || r2->value != r3->value) ) goto label$64f856d_1_5;
	r1 = false;
	goto label$64f856d_1_6;
	label$64f856d_1_5:
	r1 = true;
	label$64f856d_1_6:
	return r1;
}

void armory_trait_internal_CanvasScript_new__$3(venum* r0,kha__Image r1) {
	hl__types__ArrayObj r11;
	vvirtual *r6, *r12;
	haxe__ds__IntMap r3;
	hl__types__ArrayBytes_Int r7;
	zui__$Canvas r4;
	armory__trait__internal__CanvasScript r13;
	vbyte *r9;
	int r5, r8, r10;
	r4 = (zui__$Canvas)$g__zui_Canvas;
	r3 = r4->assetMap;
	if( r3 == NULL ) hl_null_access();
	r6 = ((Enum$t_ctx_69d0611*)r0)->p3;
	if( r6 == NULL ) hl_null_access();
	r5 = hl_vfields(r6)[1] ? (*(int*)(hl_vfields(r6)[1])) : (int)hl_dyn_geti(r6->value,23515/*id*/,&$t_i32);
	haxe_ds_IntMap_set(r3,r5,((vdynamic*)r1));
	r7 = ((Enum$t_ctx_69d0611*)r0)->p2;
	if( r7 == NULL ) hl_null_access();
	r5 = 0;
	r8 = r7->length;
	if( ((unsigned)r5) < ((unsigned)r8) ) goto label$64f856d_2_13;
	hl_types_ArrayBytes_Int___expand(r7,r5);
	label$64f856d_2_13:
	r9 = r7->bytes;
	r8 = 2;
	r8 = r5 << r8;
	r10 = *(int*)(r9 + r8);
	++r10;
	*(int*)(r9 + r8) = r10;
	r12 = ((Enum$t_ctx_69d0611*)r0)->p1;
	if( r12 == NULL ) hl_null_access();
	r11 = hl_vfields(r12)[0] ? (*(hl__types__ArrayObj*)(hl_vfields(r12)[0])) : (hl__types__ArrayObj)hl_dyn_getp(r12->value,201542029/*assets*/,&$t_hl_types_ArrayObj);
	if( r11 == NULL ) hl_null_access();
	r5 = r11->length;
	if( r10 < r5 ) goto label$64f856d_2_29;
	r13 = ((Enum$t_ctx_69d0611*)r0)->p0;
	if( r13 == NULL ) hl_null_access();
	r12 = ((Enum$t_ctx_69d0611*)r0)->p1;
	r13->canvas = r12;
	label$64f856d_2_29:
	return;
}

void armory_trait_internal_CanvasScript_new__$2(venum* r0,kha__Kravur r1) {
	bool *r24;
	String r11, r25;
	hl__types__ArrayObj r14;
	vvirtual *r4, *r5, *r8, *r13, *r20;
	venum *r23;
	haxe__format__JsonParser r10;
	hl__types__ArrayBytes_Int r17;
	zui__$Themes r6;
	zui__Zui r3;
	kha__internal__BytesBlob r12;
	vclosure *r22;
	vdynamic *r7;
	varray *r21;
	vbyte *r18;
	int r15, r16, r19;
	armory__trait__internal__CanvasScript r2;
	r2 = ((Enum$t_ctx_6313d79*)r0)->p1;
	if( r2 == NULL ) hl_null_access();
	r3 = (zui__Zui)hl_alloc_obj(&$t_zui_Zui);
	r4 = hl_alloc_virtual(&$t_vrt_a1d25bf);
	if( hl_vfields(r4)[0] ) *(kha__Kravur*)(hl_vfields(r4)[0]) = (kha__Kravur)r1; else hl_dyn_setp(r4->value,62938841/*font*/,&$t_kha_Kravur,r1);
	r6 = (zui__$Themes)$g__zui_Themes;
	r5 = r6->light;
	if( hl_vfields(r4)[1] ) *(vvirtual**)(hl_vfields(r4)[1]) = (vvirtual*)r5; else hl_dyn_setp(r4->value,260472329/*theme*/,&$t_vrt_019b9f1,r5);
	r8 = hl_to_virtual(&$t_vrt_d02fabb,(vdynamic*)r4);
	zui_Zui_new(r3,r8);
	r2->cui = r3;
	r10 = (haxe__format__JsonParser)hl_alloc_obj(&$t_haxe_format_JsonParser);
	r12 = ((Enum$t_ctx_6313d79*)r0)->p0;
	if( r12 == NULL ) hl_null_access();
	r11 = kha_internal_BytesBlob_toString(r12);
	haxe_format_JsonParser_new(r10,r11);
	r7 = haxe_format_JsonParser_doParse(r10);
	r13 = hl_to_virtual(&$t_vrt_c48771a,(vdynamic*)r7);
	if( r13 == NULL ) hl_null_access();
	r14 = hl_vfields(r13)[0] ? (*(hl__types__ArrayObj*)(hl_vfields(r13)[0])) : (hl__types__ArrayObj)hl_dyn_getp(r13->value,201542029/*assets*/,&$t_hl_types_ArrayObj);
	if( !r14 ) goto label$64f856d_3_26;
	r14 = hl_vfields(r13)[0] ? (*(hl__types__ArrayObj*)(hl_vfields(r13)[0])) : (hl__types__ArrayObj)hl_dyn_getp(r13->value,201542029/*assets*/,&$t_hl_types_ArrayObj);
	if( r14 == NULL ) hl_null_access();
	r15 = r14->length;
	r16 = 0;
	if( r15 != r16 ) goto label$64f856d_3_30;
	label$64f856d_3_26:
	r2 = ((Enum$t_ctx_6313d79*)r0)->p1;
	if( r2 == NULL ) hl_null_access();
	r2->canvas = r13;
	goto label$64f856d_3_67;
	label$64f856d_3_30:
	r15 = 4;
	r18 = hl_alloc_bytes(r15);
	r15 = 0;
	r16 = 0;
	r19 = 2;
	r19 = r15 << r19;
	*(int*)(r18 + r19) = r16;
	++r15;
	r15 = 1;
	r17 = hl_types_ArrayBase_allocI32(r18,r15);
	r15 = 0;
	r14 = hl_vfields(r13)[0] ? (*(hl__types__ArrayObj*)(hl_vfields(r13)[0])) : (hl__types__ArrayObj)hl_dyn_getp(r13->value,201542029/*assets*/,&$t_hl_types_ArrayObj);
	label$64f856d_3_42:
	if( r14 == NULL ) hl_null_access();
	r19 = r14->length;
	if( r15 >= r19 ) goto label$64f856d_3_67;
	r19 = r14->length;
	if( ((unsigned)r15) < ((unsigned)r19) ) goto label$64f856d_3_50;
	r20 = NULL;
	goto label$64f856d_3_53;
	label$64f856d_3_50:
	r21 = r14->array;
	r7 = ((vdynamic**)(r21 + 1))[r15];
	r20 = hl_to_virtual(&$t_vrt_6bfdb92,(vdynamic*)r7);
	label$64f856d_3_53:
	++r15;
	if( r20 == NULL ) hl_null_access();
	r11 = hl_vfields(r20)[2] ? (*(String*)(hl_vfields(r20)[2])) : (String)hl_dyn_getp(r20->value,150958933/*name*/,&$t_String);
	r23 = hl_alloc_enum(&$t_ctx_69d0611,0);
	r2 = ((Enum$t_ctx_6313d79*)r0)->p1;
	((Enum$t_ctx_69d0611*)r23)->p0 = (armory__trait__internal__CanvasScript)r2;
	((Enum$t_ctx_69d0611*)r23)->p1 = (vvirtual*)r13;
	((Enum$t_ctx_69d0611*)r23)->p2 = (hl__types__ArrayBytes_Int)r17;
	((Enum$t_ctx_69d0611*)r23)->p3 = (vvirtual*)r20;
	r22 = hl_alloc_closure_ptr(&$t_fun_78f6d38,armory_trait_internal_CanvasScript_new__$3,r23);
	r24 = NULL;
	r25 = NULL;
	iron_data_Data_getImage(r11,r22,r24,r25);
	goto label$64f856d_3_42;
	label$64f856d_3_67:
	return;
}

void armory_trait_internal_CanvasScript_new__$1(armory__trait__internal__CanvasScript r0,kha__internal__BytesBlob r1) {
	String r3;
	venum *r5;
	vclosure *r4;
	r3 = (String)$s_font_default_ttf;
	r5 = hl_alloc_enum(&$t_ctx_6313d79,0);
	((Enum$t_ctx_6313d79*)r5)->p0 = (kha__internal__BytesBlob)r1;
	((Enum$t_ctx_6313d79*)r5)->p1 = (armory__trait__internal__CanvasScript)r0;
	r4 = hl_alloc_closure_ptr(&$t_fun_8ecbc05,armory_trait_internal_CanvasScript_new__$2,r5);
	iron_data_Data_getFont(r3,r4);
	return;
}

void armory_trait_internal_CanvasScript_new__$4(armory__trait__internal__CanvasScript r0,kha__graphics2__Graphics r1) {
	String r11;
	hl__types__ArrayObj r5, r10;
	vvirtual *r3, *r14;
	zui__Zui r6;
	vclosure *r15;
	vdynamic *r4;
	varray *r12;
	int r7, r8, r9, r13;
	if( r0 == NULL ) hl_null_access();
	r3 = r0->canvas;
	if( r3 ) goto label$64f856d_5_4;
	return;
	label$64f856d_5_4:
	r6 = r0->cui;
	r3 = r0->canvas;
	r5 = zui_Canvas_draw(r6,r3,r1);
	r7 = 0;
	label$64f856d_5_8:
	if( r5 == NULL ) hl_null_access();
	r9 = r5->length;
	if( r7 >= r9 ) goto label$64f856d_5_41;
	r9 = r5->length;
	if( ((unsigned)r7) < ((unsigned)r9) ) goto label$64f856d_5_16;
	r11 = NULL;
	goto label$64f856d_5_19;
	label$64f856d_5_16:
	r12 = r5->array;
	r4 = ((vdynamic**)(r12 + 1))[r7];
	r11 = (String)r4;
	label$64f856d_5_19:
	++r7;
	r10 = armory_system_Event_get(r11);
	if( !r10 ) goto label$64f856d_5_40;
	r8 = 0;
	label$64f856d_5_23:
	if( r10 == NULL ) hl_null_access();
	r13 = r10->length;
	if( r8 >= r13 ) goto label$64f856d_5_40;
	r13 = r10->length;
	if( ((unsigned)r8) < ((unsigned)r13) ) goto label$64f856d_5_31;
	r14 = NULL;
	goto label$64f856d_5_34;
	label$64f856d_5_31:
	r12 = r10->array;
	r4 = ((vdynamic**)(r12 + 1))[r8];
	r14 = hl_to_virtual(&$t_vrt_68dcaf9,(vdynamic*)r4);
	label$64f856d_5_34:
	++r8;
	if( r14 == NULL ) hl_null_access();
	r15 = hl_vfields(r14)[2] ? (*(vclosure**)(hl_vfields(r14)[2])) : (vclosure*)hl_dyn_getp(r14->value,201483899/*onEvent*/,&$t_fun_7b48b4f);
	if( r15 == NULL ) hl_null_access();
	r15->hasValue ? ((void (*)(vdynamic*))r15->fun)((vdynamic*)r15->value) : ((void (*)(void))r15->fun)();
	goto label$64f856d_5_23;
	label$64f856d_5_40:
	goto label$64f856d_5_8;
	label$64f856d_5_41:
	if( r0 == NULL ) hl_null_access();
	r15 = r0->onReady;
	if( !r15 ) goto label$64f856d_5_49;
	r15 = r0->onReady;
	if( r15 == NULL ) hl_null_access();
	r15->hasValue ? ((void (*)(vdynamic*))r15->fun)((vdynamic*)r15->value) : ((void (*)(void))r15->fun)();
	r15 = NULL;
	r0->onReady = r15;
	label$64f856d_5_49:
	return;
}

void armory_trait_internal_CanvasScript_notifyOnReady(armory__trait__internal__CanvasScript r0,vclosure* r1) {
	r0->onReady = r1;
	return;
}

vvirtual* armory_trait_internal_CanvasScript_getElement(armory__trait__internal__CanvasScript r0,String r1) {
	String r9;
	vvirtual *r4, *r6;
	hl__types__ArrayObj r3;
	vdynamic *r7;
	varray *r8;
	int r2, r5;
	r2 = 0;
	r4 = r0->canvas;
	if( r4 == NULL ) hl_null_access();
	r3 = hl_vfields(r4)[1] ? (*(hl__types__ArrayObj*)(hl_vfields(r4)[1])) : (hl__types__ArrayObj)hl_dyn_getp(r4->value,-473680728/*elements*/,&$t_hl_types_ArrayObj);
	label$64f856d_7_4:
	if( r3 == NULL ) hl_null_access();
	r5 = r3->length;
	if( r2 >= r5 ) goto label$64f856d_7_21;
	r5 = r3->length;
	if( ((unsigned)r2) < ((unsigned)r5) ) goto label$64f856d_7_12;
	r6 = NULL;
	goto label$64f856d_7_15;
	label$64f856d_7_12:
	r8 = r3->array;
	r7 = ((vdynamic**)(r8 + 1))[r2];
	r6 = hl_to_virtual(&$t_vrt_5ee8da9,(vdynamic*)r7);
	label$64f856d_7_15:
	++r2;
	if( r6 == NULL ) hl_null_access();
	r9 = hl_vfields(r6)[11] ? (*(String*)(hl_vfields(r6)[11])) : (String)hl_dyn_getp(r6->value,150958933/*name*/,&$t_String);
	if( r9 != r1 && (!r9 || !r1 || String___compare(r9,(vdynamic*)r1) != 0) ) goto label$64f856d_7_20;
	return r6;
	label$64f856d_7_20:
	goto label$64f856d_7_4;
	label$64f856d_7_21:
	r6 = NULL;
	return r6;
}

hl__types__ArrayObj armory_trait_internal_CanvasScript_getElements(armory__trait__internal__CanvasScript r0) {
	vvirtual *r2;
	hl__types__ArrayObj r1;
	r2 = r0->canvas;
	if( r2 == NULL ) hl_null_access();
	r1 = hl_vfields(r2)[1] ? (*(hl__types__ArrayObj*)(hl_vfields(r2)[1])) : (hl__types__ArrayObj)hl_dyn_getp(r2->value,-473680728/*elements*/,&$t_hl_types_ArrayObj);
	return r1;
}

zui__Handle armory_trait_internal_CanvasScript_getHandle(armory__trait__internal__CanvasScript r0,String r1) {
	vvirtual *r7;
	haxe__ds__IntMap r3;
	zui__$Canvas r5;
	zui__Handle r4;
	vdynamic *r2;
	int r6;
	r5 = (zui__$Canvas)$g__zui_Canvas;
	r4 = r5->h;
	if( r4 == NULL ) hl_null_access();
	r3 = r4->children;
	if( r3 == NULL ) hl_null_access();
	r7 = armory_trait_internal_CanvasScript_getElement(r0,r1);
	if( r7 == NULL ) hl_null_access();
	r6 = hl_vfields(r7)[10] ? (*(int*)(hl_vfields(r7)[10])) : (int)hl_dyn_geti(r7->value,23515/*id*/,&$t_i32);
	r2 = haxe_ds_IntMap_get(r3,r6);
	r4 = (zui__Handle)r2;
	return r4;
}

void armory_trait_internal_CanvasScript_new(armory__trait__internal__CanvasScript r0,String r1) {
	String r5, r6;
	vvirtual *r3;
	vclosure *r2, *r7, *r8;
	r2 = NULL;
	r0->onReady = r2;
	r3 = NULL;
	r0->canvas = r3;
	iron_Trait_new(((iron__Trait)r0));
	r6 = (String)$s__json;
	r5 = String___add__(r1,r6);
	r7 = hl_alloc_closure_ptr(&$t_fun_45efdfd,armory_trait_internal_CanvasScript_new__$1,r0);
	iron_data_Data_getBlob(r5,r7);
	r8 = hl_alloc_closure_ptr(&$t_fun_3559b8d,armory_trait_internal_CanvasScript_new__$4,r0);
	iron_Trait_notifyOnRender2D(((iron__Trait)r0),r8);
	return;
}

